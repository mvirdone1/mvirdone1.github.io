var w100Points = {
  features: [
    {
      geometry: {
        coordinates: [-111.6539083333333, 40.82807500000001, 0, 0],
        type: "Point",
      },
      id: "1ccd582a-9779-4b9b-bd14-a7c98579887b",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 18",
        "stroke-width": 2,
        title: "Big Mountain Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.579788551882, 40.49130935015199, 0, 0],
        type: "Point",
      },
      id: "207e82bd-5e63-478f-b81e-6f7dac3bafa6",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 59",
        "stroke-width": 2,
        title: "Rock Springs Water Stop",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.6051041187087, 40.66146923888883, 0, 0],
        type: "Point",
      },
      id: "4dc8bc12-c56f-47c1-bf4b-18e36e83a506",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 38",
        "stroke-width": 2,
        title: "Desolation Lake Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.7085076474392, 40.76069017772576, 0, 0],
        type: "Point",
      },
      id: "76b854ef-62c1-42f2-a547-1154b2e5860d",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 23",
        "stroke-width": 2,
        title: "Alexander Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5680895841307, 40.62753454557323, 0, 0],
        type: "Point",
      },
      id: "99a58248-ca59-4785-be69-77149712c8e6",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 40",
        "stroke-width": 2,
        title: "Scotts Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.8015403805741, 40.99249299059591, 0, 0],
        type: "Point",
      },
      id: "99ec8c75-a1c2-446f-8a8b-0cef1a7d31e4",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 5",
        "stroke-width": 2,
        title: "Grobben's Water Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.763017917634, 40.8813597514856, 0, 0],
        type: "Point",
      },
      id: "a8215c50-de61-406e-bbf6-a6a218f45472",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 9",
        "stroke-width": 2,
        title: "Sessions Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5706362710562, 40.53152599443411, 0, 0],
        type: "Point",
      },
      id: "a8b0dedc-9077-4eff-b557-a0ed4994fad3",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 54",
        "stroke-width": 2,
        title: "Pole Line Pass Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.7930063930052, 40.9302781377116, 0, 0],
        type: "Point",
      },
      id: "a966c15d-10ce-418a-990d-98e31b3f0202",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 7",
        "stroke-width": 2,
        title: "Bountiful B Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.9048735687737, 41.04667436035124, 0, 0],
        type: "Point",
      },
      id: "ab28215a-8635-446a-94af-bcd81c439c47",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 1",
        "stroke-width": 2,
        title: "Start",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5126539980399, 40.46284855113357, 0, 0],
        type: "Point",
      },
      id: "adf0290a-e130-478b-b8cb-4f768733bd1b",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 72",
        "stroke-width": 2,
        title: "Decker Canyon Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5859346771731, 40.56363808298993, 0, 0],
        type: "Point",
      },
      id: "c202bb81-a24b-4a97-95d5-9efb365bb12d",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 51",
        "stroke-width": 2,
        title: "Ant Knolls Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.537635676748, 40.46097916195207, 0, 0],
        type: "Point",
      },
      id: "dc94f686-e3aa-4677-b041-fbc3a0601501",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 70",
        "stroke-width": 2,
        title: "Top of the Wall",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.6471158389683, 40.68454337260243, 0, 0],
        type: "Point",
      },
      id: "e3e0ce45-55d0-4ce1-888a-3e4ac595f0de",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 35",
        "stroke-width": 2,
        title: "Big Water Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.6727074864511, 40.74006400131721, 0, 0],
        type: "Point",
      },
      id: "e40d9416-f7d5-4517-8833-9cd8ed380453",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 29",
        "stroke-width": 2,
        title: "Lambs Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5842846194845, 40.5977412492636, 0, 0],
        type: "Point",
      },
      id: "e82a84d0-2756-41d8-ba4f-b36e40a169d3",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 46",
        "stroke-width": 2,
        title: "Brighton Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5432998421288, 40.51632463498631, 0, 0],
        type: "Point",
      },
      id: "e8858209-988b-4c05-9661-abed625f2ed9",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 66",
        "stroke-width": 2,
        title: "Pot Hollow Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.4945899634749, 40.48180805347558, 0, 0],
        type: "Point",
      },
      id: "eac22108-b452-4ec8-8188-9085144b366f",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 75",
        "stroke-width": 2,
        title: "Finish Line",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
    {
      geometry: {
        coordinates: [-111.5311912484872, 40.48102648338714, 0, 0],
        type: "Point",
      },
      id: "fc5f16bd-1ea2-41e8-ac93-1d4334aec178",
      type: "Feature",
      properties: {
        "marker-symbol": "point",
        creator: "0MGPA2",
        description: "This is waypoint no: 69",
        "stroke-width": 2,
        title: "Staton Aid Station",
        stroke: "#FF0000",
        class: "Marker",
        updated: 1659374524000,
      },
    },
  ],
  type: "FeatureCollection",
};

// This function sorts the variable by the aid station number
function initGeoJson(GeoJson) {
  /*for (
    var stationIdx = 0;
    stationIdx < Object.keys(GeoJson.features).length;
    stationIdx++
  ) */

  var stationIdx = 0;
  GeoJson.features.sort((a, b) => {
    const waypointA = parseInt(a.properties.description.match(/\d+/)[0]);
    const waypointB = parseInt(b.properties.description.match(/\d+/)[0]);
    return waypointA - waypointB;
  });

  for (const currStation of GeoJson.features) {
    // currStation = GeoJson[stationIdx];
    console.log(
      stationIdx +
        ": " +
        currStation.properties.description +
        " " +
        currStation.properties.title +
        " " +
        currStation.geometry.coordinates[1] +
        "," +
        currStation.geometry.coordinates[0]
    );
    stationIdx++;
  }
}

function handleDropDownChangeW100(selectedOption, w100Points) {
  const plotter = new WeatherPlotter();
  var currStation = w100Points.features[selectedOption];
  var weatherPlotParamObject = {
    lat: currStation.geometry.coordinates[1],
    lon: currStation.geometry.coordinates[0],
    office: "", //locationObject.weatherOffice,
    hours: 48,
    pmcdArray: [
      GraphTypes.Temperature,
      GraphTypes.WindChill,
      GraphTypes.Snow,
      GraphTypes.Rain,
      GraphTypes.SurfaceWind,
      GraphTypes.ProbQPF01,
      GraphTypes.ProbQPF025,
      GraphTypes.ProbQPF05,
      GraphTypes.ProbQPF1,
      GraphTypes.ProbQPF2,
      GraphTypes.ProbSnow01,
      GraphTypes.ProbSnow1,
      GraphTypes.ProbSnow3,
      GraphTypes.ProbSnow6,
      GraphTypes.ProbSnow12,
      GraphTypes.SkyCover,
      GraphTypes.PrecipitationPotential,
    ],
  };

  const weatherHourlyURL = plotter.createHourlyWeatherPlotUrl(
    weatherPlotParamObject,
    "myPlot"
  );
  document.getElementById("myHeading").textContent =
    currStation.properties.title;
}

function initW100() {
  initGeoJson(w100Points);

  var selectMenu = document.createElement("select");

  var stationIdx = 0;

  for (const currStation of w100Points.features) {
    option = document.createElement("option");
    option.text = currStation.properties.title;
    option.value = stationIdx;
    selectMenu.add(option);
    stationIdx++;
  }

  document.body.append(selectMenu);
  selectMenu.addEventListener("change", function () {
    var selectedOption = parseInt(
      selectMenu.options[selectMenu.selectedIndex].value
    );
    console.log("Selected option: " + selectedOption);
    handleDropDownChangeW100(selectedOption, w100Points);
  });

  var newHeading = document.createElement("h3");
  newHeading.id = "myHeading";
  // newHeading.textContent = currStation.properties.title;
  document.body.append(newHeading);

  //var plotId = divify(currStation.properties.title);
  // Create the image element
  var img = document.createElement("img");
  //img.id = plotId;
  img.id = "myPlot";
  img.alt = "Weather Plot";
  document.body.append(img);

  // Init to default value
  handleDropDownChangeW100(0, w100Points);
}
